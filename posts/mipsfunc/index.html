<!doctype html><html lang=en dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>MIPS中的函数调用 | coder0xe's blog</title><meta name=keywords content="计组"><meta name=description content="MIPS函数调用"><meta name=author content="sudo"><link rel=canonical href=https://coder0xe.github.io/posts/mipsfunc/><link crossorigin=anonymous href=/assets/css/stylesheet.e4a36188e2c44563c1cc5ed1a2d0b8451a4f68c685114d738b97609f82dae050.css integrity="sha256-5KNhiOLERWPBzF7RotC4RRpPaMaFEU1zi5dgn4La4FA=" rel="preload stylesheet" as=style><link rel=icon href=https://coder0xe.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://coder0xe.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://coder0xe.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://coder0xe.github.io/apple-touch-icon.png><link rel=mask-icon href=https://coder0xe.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://coder0xe.github.io/posts/mipsfunc/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><meta property="og:url" content="https://coder0xe.github.io/posts/mipsfunc/"><meta property="og:site_name" content="coder0xe's blog"><meta property="og:title" content="MIPS中的函数调用"><meta property="og:description" content="MIPS函数调用"><meta property="og:locale" content="zh-CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-09-13T23:24:00+08:00"><meta property="article:modified_time" content="2023-09-13T23:24:00+08:00"><meta property="article:tag" content="Sep"><meta name=twitter:card content="summary"><meta name=twitter:title content="MIPS中的函数调用"><meta name=twitter:description content="MIPS函数调用"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://coder0xe.github.io/posts/"},{"@type":"ListItem","position":2,"name":"MIPS中的函数调用","item":"https://coder0xe.github.io/posts/mipsfunc/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"MIPS中的函数调用","name":"MIPS中的函数调用","description":"MIPS函数调用","keywords":["计组"],"articleBody":"函数调用 一.调用初印象 ​\t最早接触到函数调用是在选择排序程序中，教学视频中代码块来换回拼接导致我看了好几遍视频！ 下面附上源码\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 .data array: .space 400 // 申请数组空间 message_input_n: .asciiz \"please input an integer as the length of the sequence\\n\" message_input_array: .asciiz \"please input an integer followed with a line breaker\\n\" message_output_array: .asciiz \"the sorted sequence is:\\n\" space: .asciiz \" \" stack: .space 100 // 申请栈空间 .globl main // 在代码段起始位置声明main为全局符号 .text input: la $a0,message_input_n li $v0,4 syscall li $v0,5 // number of integers to be sorted syscall // the number is stored in $v0 move $t0, $v0 // set $t0 to the contents of $v0 li $t1, 0 // 循环变量 for_1_begin: slt $t2, $t1, $t0 // t2=1 if t1 \u003c t0 beq $t2, $zero, for_1_end nop // 目标指令紧跟分支指令 增加延时槽防止并行性引起错误 //下面这段代码实际上是在计算存入地址 // 存入地址 = 首地址 + 循环变量 * 4 la $t2, array / 将数组首地址存入t2 li $t3, 4 mult $t3, $t1 // t3 * t1 高位存入 hi，低位存入lo 事实上一般的乘法，只要结果不超过32位，lo中的值就是完整的答案 mflo $t3 // 将lo寄存器中移动到t3（所有的move指令都相当于赋值语句，复制后原值不会改变，而不是“移动”） addu $t2, $t2, $t3 //在首地址t2基础上加上偏移量t3 la $a0,message_input_array //输出前导字符串 li $v0,4 syscall li $v0, 5 //输入数字 syscall sw $v0, 0($t2) // 从寄存器存入数组中对应的地址 这里的t2就是刚刚计算过的地址 addi $t1, $t1, 1\t// 循环变量++ j for_1_begin nop for_1_end: move $v0, $t0 jr $ra //跳回到主程序，跳转语句的下一条语句 nop //与input同理 无需多言！ output: move $t0, $a0 li $t1,0 la $a0,message_output_array li $v0,4 syscall for_2_begin: slt $t2, $t1, $t0 beq $t2, $zero, for_2_end nop la $t2, array li $t3, 4 mult $t3, $t1 mflo $t3 addu $t2, $t2, $t3 lw $a0,0($t2) li $v0,1 syscall la $a0,space li $v0,4 syscall addi $t1, $t1, 1\tj for_2_begin nop for_2_end: jr $ra nop sort: addiu $sp,$sp,-32 //向低地址移动32字节 move $t0,$a0 //此时a0值即为元素个数 li $t1,0 //循环变量 for_4_begin: slt $t2, $t1, $t0 //选择排序外层循环n-1趟 beq $t2, $zero, for_4_end nop //计算地址 la $t2, array li $t3, 4 mult $t1, $t3 mflo $t3 addu $t2, $t2, $t3 move $a0, $t0 move $a1, $t1 //父函数维护t寄存器 入栈 需要注意的是多层调用时$ra的维护 sw $t2, 28($sp) sw $t1, 24($sp) sw $t0, 20($sp) sw $ra, 16($sp) //这时的ra值需要保存 这里的ra值记录的是返回到主函数的指令地址 经过调用findmin后会变为返回到sort的地址! jal findmin //调用子函数 nop //出栈 lw $ra, 16($sp) lw $t0, 20($sp) lw $t1, 24($sp) lw $t2, 28($sp) //交换值 v0地址与t2地址处存储的值,两个寄存器分别存储 lw $t3, 0($v0) lw $t4, 0($t2) sw $t3, 0($t2) sw $t4, 0($v0) addi $t1,$t1,1 //更新循环变量 j for_4_begin nop for_4_end: addiu $sp,$sp,32 //将申请的栈空间退回，栈指针回到高地址 jr $ra //回到主程序 nop findmin: //从sort中传入 a0值为n, a1值为外层循环变量i la $t0,array sll $a0,$a0,2 subi $a0,$a0,4 //需要注意的是在 * 4的基础上需要减去4， addu $t0,$t0,$a0 //当前的地址是数组中最后一个元素的地址 lw $t1, 0($t0) // t1=a[n-1] move $t2,$t0 move $t3,$t0 // t3 = t2 = t0 = 最后一个元素地址 // a[i+1] la $t0,array sll $a1,$a1,2 addu $t0,$t0,$a1// t0此时为a[i+1]地址 for_3_begin: sge $t4,$t3,$t0 // t4 = 1 if t3 \u003e= t0 beq $t4,$zero,for_3_end nop lw $t5,0($t3) // t5=a[n-1] // 进入查找时 t3为最后一个元素地址 ,t0为a[i+1]地址 //这里寻找最小值的操作实际上是从末尾开始的，先记t1=a[n-1]为最小值，之后由哨兵 t5=遍历到的值 从n-1逐步向前遍历直到 i+1 //不断更新t1的值作为新的最小值，并在t2中保存最小值地址 t3 //这里t1被设置为保存最小值 如果当前遍历的元素小于t1最小值则进入下方更新最小值操作，否则进入if_1_else,顺序进入if_1_end遍历 //下一个元素 slt $t6,$t5,$t1 // t6 = 1 if t5 \u003c t1 第一次运行时 t5 = t1 直接跳转到 if_1_else beq $t6,$zero,if_1_else nop move $t1,$t5 //更新最小值 move $t2,$t3 //保存最小值在数组中的的地址 j if_1_end nop if_1_else:// if_1_else后误操作则直接执行 if_1_end 在标签之间无跳转时按照顺序执行 if_1_end: subi $t3,$t3,4 //t3从末尾向前移动一个元素，更新遍历元素 j for_3_begin nop for_3_end: move $v0,$t2 jr $ra //回到主程序 nop main: la $sp, stack addiu $sp,$sp,100 //此处sp+100是将指针向高地址移动 addiu $sp,$sp,-20 //-20向低地址移动 jal input //跳转到input nop move $t0,$v0 //回到位置 move $a0,$t0 sw $t0, 16($sp) //向高地址偏移量为16 调用者维护t寄存器，将t0入栈 jal sort nop lw $t0,16($sp) // t0出栈 move $a0,$t0 jal output nop addiu $sp,$sp,20 li $v0,10 //程序结束 syscall ​\t上述选择排序算法较为复杂，主体结构为main调用input,sort,output函数，在sort中又调用findmin子函数\n在MARS中的运行配置：\ndelayed branching initial program counter to global “main” if defined address configuration: compact ,data at address 0 ​\t需要注意的是多层函数调用时除了经典的父函数维护t寄存器，子函数维护s寄存器，还要对ra寄存器进行维护,经典的例子是在sort调用findmin过程中，$ra一开始存储的值是sort函数返回到主函数main下一条指令的地址，经过调用findmin,寄存器$ra中的值会被自动更新为findmin跳回到sort的指令地址，故需要保存跳回到main的指令地址，对$ra进行维护！！！\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 //选择排序的C语言实现 void selectSort(int k[],int n) { int i,j,d; int temp; for(i=0;i\u003cn-1;i++){ d=i; for(j=i+1;j\u003cn;j++){//从后n-i+1中选取 if(k[j]\u003ck[d])d=j; //找到后面最小的元素 } if(d!=i)//放在排好队的序列最后面 { temp=k[d]; k[d]=k[i]; k[i]=temp; } } } 二.函数调用 ​\t对于函数调用，可以看成在函数调用的这条语句，程序跳转到函数的内容处开始执行，执行完整个函数后再跳转回到调用处向下执行，这个跳转过程可以用汇编语言中的跳转指令和标签实现。\n# function call jal function_name # function function_name: jr $ra ​\t在这里我们的跳转指令选择jal而非j, jal = jump and link,相比j指令，jal多了将PC+4 写入$ra的过程,即记录跳转语句下一条语句的地址。当函数结束时，会返回到之前调用它的位置，并执行下一条指令。故我们常常搭配使用jal和j.\n​ 例如简单的C语言代码，计算两数相加\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 #include int sum(int a, int b) { int tmp = a + b; return tmp; } int main() { int a = 2; int b = 3; int ans = sum(a, b); printf(\"%d\\n\", ans); return 0; } ​ 翻译成汇编语言\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 .macro end li $v0,10 syscall .end_macro .text main: li $s0, 2 li $s1, 3 jal sum move $a0, $s2 li $v0,1 syscall end //marco sum: add $s2,$s0,$s1 jr $ra 三.复用代码 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 int sum(int a, int b) { int tmp = a + b; return tmp; } int main() { int a = 2; int b = 3; int c = 4; int d = 5; int sum1 = sum(a, b); printf(\"%d\", sum1); sum2 = sum(c, d); printf(\"%d\", sum2); return 0; } ​\t上面的C程序，sum代码是可以进行复用的，但是在我们原来的汇编代码中，操作的寄存器是固定的，即$s0,$s1,$s2,为了复用代码（可以对其他寄存器进行操作），就必须要让一些特定寄存器作为“接收器”，对于不同的参数，都采用同一组寄存器来存储它们的值，也就是我们说的函数传参寄存器$a0.$a1,$a2,$a3,同样，对于返回值，也需要指定特定的寄存器。\n//利用宏进行代码复用 .macro end li $v0,10 syscall .end_macro .macro printStr(%Str) la $a0,%Str li $v0,4 syscall .end_macro .data space: .asciiz \" \" .text li $t0,1 li $t1,2 li $t2,3 li $t3,4 #传参 $a0,$a1作为桥梁作用 move $a0,$s0 move $a1,$s1 jal sum move $s4,$v0 li $v0,1 move $a0,$s4 syscall printStr(space) move $a0,$s2 move $a1,$s3 jal sum move $s5,$v0 li $v0,1 move $a0,$s5 syscall end sum: #传参 move $t0,$a0 move $t1,$a1 add $v0,$t0,$t1 jr $ra ​\t如果传参过程中$a0,$a1,$a2,$a3不够用（参数超过四个），可以利用栈$sp,将多余的参数存入内存中。\n四.避免对外界造成影响 ​\t函数还有一个重要的功能是不对函数体外的变量造成不必要的影响\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 int sum(int a, int b) { int tmp = a + b; return tmp; } int main() { int a = 2; int b = 3; int c = 4; int sum1 = sum(a, b); int sum2 = sum(sum1, c); printf(\"%d\", sum2); return 0; } ​\t汇编\n.macro end li $v0, 10 syscall .end_macro .text li $s0, 2 li $s1, 3 li $t0, 4 move $a0, $s0 #传参 move $a1, $s1 jal sum move $s4, $v0 #获得返回值 move $a0, $s4 move $a1, $t0 jal sum move $s5, $v0 li $v0, 1 move $a0, $s5 syscall end sum: #传参过程 move $t0, $a0 #t0被修改了 move $t1, $a1 #函数过程 add $v0 $t0, $t1 jr $ra ​\t这里的问题在于，$t0在主函数中存储变量值,而在sum函数中用于接受参数，改变了原来的变量值，即函数对外部产生了影响！\n​\t所以我们需要保证函数不会对外部造成影响，方法就是应用栈，利用栈来保存和恢复函数中所使用的寄存器。\n在哪里维护寄存器：\nt寄存器：在调用者中进行维护‘ s寄存器：在被调用者中进行维护 1.在调用者中进行维护 .macro end li $v0, 10 syscall .end_macro .text li $s0, 2 li $s1, 3 li $t0, 4 move $a0, $s0 #传参 move $a1, $s1 #进行维护 入栈 sw $t0, 0($sp) addi $sp, $sp, -4 jal sum #出栈 addi $sp, $sp, 4 lw $t0, 0($sp) move $s4, $v0 #获得返回值 move $a0, $s4 move $a1, $t0 sw $t0, 0($sp) #入栈 addi $sp, $sp, -4 jal sum addi $sp, $sp, 4 #出栈 lw $t0, 0($sp) move $s5, $v0 li $v0, 1 move $a0, $s5 syscall end sum: #传参过程 move $t0, $a0 move $t1, $a1 #函数过程 add $v0 $t0, $t1 jr $ra ​\t**在以上代码中，只涉及到对t寄存器的维护，故只需要在主函数中使用栈，在子函数中无需使用栈，**在发觉这一点之前，我对于主函数中对于栈指针$sp移动的操作表示迷惑，认为完全可以删去这两行代码。事实上，如果在一个参数的入栈与出栈之间没有对$sp进行任何操作，确实可以不移动$sp,但事实上，考虑到我们习惯上第一个参数入栈表达为 lw $s0 0($sp),即相对于栈指针地址没有偏移，而如果我们在子函数中这样存入，在主函数中又没有移动$sp,无疑会覆盖掉我们在那个位置上保存的参数，从而发生bug,(杠精当然可以说我会写lw $s0, 4($sp)），但这样写在主函数中维护寄存器数量很多时很费笔墨，不如移动栈指针来的简洁。当然，我们在子函数中同样需要注意栈指针的移动，在子函数结束时即使释放栈空间，防止覆写主函数中维护的参数。\n2.在被调用者中维护 .macro end li $v0, 10 syscall .end_macro .text li $s0, 2 li $s1, 3 li $t0, 4 move $a0, $s0 #传参 move $a1, $s1 jal sum move $s4, $v0 #获得返回值 move $a0, $s4 move $a1, $t0 jal sum move $s5, $v0 li $v0, 1 move $a0, $s5 syscall end sum: #入栈过程 sw $t0, 0($sp) addi $sp, $sp, -4 #传参过程 move $t0, $a0 move $t1, $a1 #函数过程 add $v0 $t0, $t1 #出栈过程 addi $sp, $sp, 4 lw $t0, 0($sp) #return jr $ra 五.嵌套函数调用 ​\t嵌套函数调用的重要意识是用栈保存$ra，以保存向外层函数的跳转，这一点我在sort程序中就有发现，还是有一定理解能力(bushi).\n​\t嵌套函数的C语言例子\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 int sum(int a, int b) { return a + b; } int cal(int a, int b) { return a - sum(b, a); } int main() { int a = 2; int b = 3; int ans = cal(2, 3); printf(\"%d\", ans); } ​\t其中cal函数嵌套调用sum函数。\n.macro end li $v0, 10 syscall .end_macro .text li $s0, 2 li $s1, 3 move $a0, $s0 move $a1, $s1 jal cal move $s5, $v0 li $v0, 1 move $a0, $s5 syscall end sum: #传参过程 move $t0, $a0 move $t1, $a1 #函数过程 add $v0, $t0, $t1 #return jr $ra cal: #传参过程 move $t0, $a0 move $t1, $a1 #调用sum的过程 move $a0, $t1 move $a1, $t0 jal sum move $t2, $v0 #运算a-sum(b, a) sub $v0, $t0, $t2 #return jr $ra #错误的地址值 造成死循环 ​\t这段代码会陷入死循环！在cal调用sum时，$ra中的值由cal跳回主函数的地址由jal指令更改为sum跳回cal的地址，因此会陷入死循环。\n​\t所以我们可以总结出：在嵌套函数调用中，一旦一个函数不是叶子函数（调用逻辑的最低端），就需要保存和恢复$ra,以能够正常一层一层向上返回。\n​\t以下为在父一级函数中对$ra进行维护的正确代码\n.macro end li $v0, 10 syscall .end_macro .text li $s0, 2 li $s1, 3 move $a0, $s0 move $a1, $s1 jal cal move $s5, $v0 li $v0, 1 move $a0, $s5 syscall end sum: #将 $t0 和 $t1 入栈 sw $t0, 0($sp) addi $sp, $sp, -4 sw $t1, 0($sp) addi $sp, $sp, -4 #传参过程 move $t0, $a0 move $t1, $a1 #函数过程 add $v0 $t0, $t1 #将 $t0 和 $t1 出栈 addi $sp, $sp, 4 lw $t1, 0($sp) addi $sp, $sp, 4 lw $t0, 0($sp) #return jr $ra cal: #将 $ra 入栈 sw $ra, 0($sp) addi $sp, $sp, -4 #传参过程 move $t0, $a0 move $t1, $a1 #调用 sum 的过程 move $a0, $t1 move $a1, $t0 jal sum move $t2, $v0 #运算a-sum(b, a) sub $v0, $t0, $t2 #将ra出栈 addi $sp, $sp, 4 lw $ra, 0($sp) #return jr $ra 六.递归函数调用 ​\t最后的部分：递归函数的汇编翻译，递归函数的本质是一个在函数体内调用自身的嵌套函数。\n​\tC语言阶乘\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 #include int factorial(int n) { if (n == 1) { return 1; } else { return n * factorial(n - 1); } } int main() { printf(\"%d\\n\", factorial(5)); return 0; } ​\t汇编版本\n# 程序结束 .macro end li $v0, 10 syscall .end_macro # 从标准输入处得到一个整型变量，并存储到 %des 寄存器中 .macro getInt(%des) li $v0, 5 syscall move %des, $v0 .end_macro # 向标准输出中写入一个数据，这个数据保存在 %src 寄存器中 .macro printInt(%src) move $a0, %src li $v0, 1 syscall .end_macro # 将寄存器 %src 中的数据入栈 .macro push(%src) sw %src, 0($sp) subi $sp, $sp, 4 #入栈栈指针向低地址移动 .end_macro # 将栈顶数据出栈，并保存在 %des 寄存器中 .macro pop(%des) addi $sp, $sp, 4 # 出栈栈指针向高地址移动 lw %des, 0($sp) .end_macro .text main: getInt($s0) move $a0, $s0 jal factorial #最终结果存储在$v0中 move $s1, $v0 printInt($s1) end factorial: # 入栈 push($ra) push($t0) # 传参 move $t0, $a0 #函数过程 bne $t0, 1, else # 基准情况 if: li $v0, 1 j if_end # 递归情况 else: subi $t1, $t0, 1 move $a0, $t1 jal factorial mult $t0, $v0 mflo $v0 if_end: # 出栈 pop($t0) pop($ra) # 返回 jr $ra ​\t我们可以预想到，调用过递归函数的栈中，一定是整整齐齐的存储了一排$ra值\n","wordCount":"1864","inLanguage":"en","datePublished":"2023-09-13T23:24:00+08:00","dateModified":"2023-09-13T23:24:00+08:00","author":{"@type":"Person","name":"sudo"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://coder0xe.github.io/posts/mipsfunc/"},"publisher":{"@type":"Organization","name":"coder0xe's blog","logo":{"@type":"ImageObject","url":"https://coder0xe.github.io/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://coder0xe.github.io/ accesskey=h title="coder0xe's blog (Alt + H)">coder0xe's blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://coder0xe.github.io/ title=首页><span>首页</span></a></li><li><a href=https://coder0xe.github.io/categories/ title=分类><span>分类</span></a></li><li><a href=https://coder0xe.github.io/tags/ title=标签><span>标签</span></a></li><li><a href=https://coder0xe.github.io/archives/ title=归档><span>归档</span></a></li><li><a href=https://coder0xe.github.io/search/ title=搜索><span>搜索</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://coder0xe.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://coder0xe.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">MIPS中的函数调用</h1><div class=post-description>MIPS函数调用</div><div class=post-meta><span title='2023-09-13 23:24:00 +0800 +0800'>September 13, 2023</span>&nbsp;·&nbsp;<span>9 min</span>&nbsp;·&nbsp;<span>sudo</span></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e5%87%bd%e6%95%b0%e8%b0%83%e7%94%a8 aria-label=函数调用>函数调用</a><ul><li><a href=#%e4%b8%80%e8%b0%83%e7%94%a8%e5%88%9d%e5%8d%b0%e8%b1%a1 aria-label=一.调用初印象>一.调用初印象</a></li><li><a href=#%e4%ba%8c%e5%87%bd%e6%95%b0%e8%b0%83%e7%94%a8 aria-label=二.函数调用>二.函数调用</a></li><li><a href=#%e4%b8%89%e5%a4%8d%e7%94%a8%e4%bb%a3%e7%a0%81 aria-label=三.复用代码>三.复用代码</a></li><li><a href=#%e5%9b%9b%e9%81%bf%e5%85%8d%e5%af%b9%e5%a4%96%e7%95%8c%e9%80%a0%e6%88%90%e5%bd%b1%e5%93%8d aria-label=四.避免对外界造成影响>四.避免对外界造成影响</a><ul><li><a href=#1%e5%9c%a8%e8%b0%83%e7%94%a8%e8%80%85%e4%b8%ad%e8%bf%9b%e8%a1%8c%e7%bb%b4%e6%8a%a4 aria-label=1.在调用者中进行维护>1.在调用者中进行维护</a></li><li><a href=#2%e5%9c%a8%e8%a2%ab%e8%b0%83%e7%94%a8%e8%80%85%e4%b8%ad%e7%bb%b4%e6%8a%a4 aria-label=2.在被调用者中维护>2.在被调用者中维护</a></li></ul></li><li><a href=#%e4%ba%94%e5%b5%8c%e5%a5%97%e5%87%bd%e6%95%b0%e8%b0%83%e7%94%a8 aria-label=五.嵌套函数调用>五.嵌套函数调用</a></li><li><a href=#%e5%85%ad%e9%80%92%e5%bd%92%e5%87%bd%e6%95%b0%e8%b0%83%e7%94%a8 aria-label=六.递归函数调用>六.递归函数调用</a></li></ul></li></ul></div></details></div><div class=post-content><h3 id=函数调用>函数调用<a hidden class=anchor aria-hidden=true href=#函数调用>#</a></h3><h4 id=一调用初印象>一.调用初印象<a hidden class=anchor aria-hidden=true href=#一调用初印象>#</a></h4><p>​ 最早接触到函数调用是在选择排序程序中，<strong>教学视频中代码块来换回拼接导致我看了好几遍视频！</strong> 下面附上源码</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">112
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">113
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">114
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">115
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">116
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">117
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">118
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">119
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">120
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">121
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">122
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">123
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">124
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">125
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">126
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">127
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">128
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">129
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">130
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">131
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">132
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">133
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">134
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">135
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">136
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">137
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">138
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">139
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">140
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">141
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">142
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">143
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">144
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">145
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">146
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">147
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">148
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">149
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">150
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">151
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">152
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">153
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">154
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">155
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">156
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">157
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">158
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">159
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">160
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">161
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">162
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">163
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">164
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">165
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">166
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">167
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">168
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">169
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">170
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">171
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">172
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">173
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">174
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">175
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">176
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">177
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">178
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">179
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">180
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">181
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">182
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">183
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">184
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">185
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">186
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">187
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">188
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">189
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">190
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">191
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">192
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">193
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">194
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">195
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">196
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">197
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">198
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">199
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">200
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">201
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">202
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">203
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">204
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">205
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">206
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">207
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">208
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">209
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">210
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">211
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">212
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">213
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-c data-lang=c><span style=display:flex><span>.data 
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>array</span>: .space <span style=color:#bd93f9>400</span> <span style=color:#6272a4>// 申请数组空间
</span></span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>message_input_n</span>: .asciiz <span style=color:#f1fa8c>&#34;please input an integer as the length of the sequence</span><span style=color:#f1fa8c>\n</span><span style=color:#f1fa8c>&#34;</span>
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>message_input_array</span>: .asciiz <span style=color:#f1fa8c>&#34;please input an integer followed with a line breaker</span><span style=color:#f1fa8c>\n</span><span style=color:#f1fa8c>&#34;</span>
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>message_output_array</span>: .asciiz <span style=color:#f1fa8c>&#34;the sorted sequence is:</span><span style=color:#f1fa8c>\n</span><span style=color:#f1fa8c>&#34;</span>
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>space</span>: .asciiz <span style=color:#f1fa8c>&#34; &#34;</span>
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>stack</span>: .space <span style=color:#bd93f9>100</span> <span style=color:#6272a4>// 申请栈空间
</span></span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>.globl main  <span style=color:#6272a4>// 在代码段起始位置声明main为全局符号
</span></span></span><span style=display:flex><span>.text 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>input</span>:
</span></span><span style=display:flex><span>    la $a0,message_input_n
</span></span><span style=display:flex><span>    li $v0,<span style=color:#bd93f9>4</span>
</span></span><span style=display:flex><span>    syscall
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    li $v0,<span style=color:#bd93f9>5</span>   <span style=color:#6272a4>// number of integers to be sorted  
</span></span></span><span style=display:flex><span>    syscall    <span style=color:#6272a4>// the number is stored in $v0
</span></span></span><span style=display:flex><span>    move $t0, $v0 <span style=color:#6272a4>// set $t0 to the contents of $v0
</span></span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    li $t1, <span style=color:#bd93f9>0</span>  <span style=color:#6272a4>// 循环变量
</span></span></span><span style=display:flex><span>    <span style=color:#8be9fd;font-style:italic>for_1_begin</span>:
</span></span><span style=display:flex><span>    slt $t2, $t1, $t0  <span style=color:#6272a4>// t2=1 if t1 &lt; t0
</span></span></span><span style=display:flex><span>    beq $t2, $zero, for_1_end
</span></span><span style=display:flex><span>    nop                <span style=color:#6272a4>// 目标指令紧跟分支指令 增加延时槽防止并行性引起错误
</span></span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span> <span style=color:#6272a4>//下面这段代码实际上是在计算存入地址
</span></span></span><span style=display:flex><span> <span style=color:#6272a4>// 存入地址 = 首地址 + 循环变量 * 4
</span></span></span><span style=display:flex><span>    la $t2, array  <span style=color:#ff79c6>/</span> 将数组首地址存入t2
</span></span><span style=display:flex><span>    li $t3, <span style=color:#bd93f9>4</span>
</span></span><span style=display:flex><span>    mult $t3, $t1  <span style=color:#6272a4>// t3 * t1 高位存入 hi，低位存入lo 事实上一般的乘法，只要结果不超过32位，lo中的值就是完整的答案
</span></span></span><span style=display:flex><span>    mflo $t3       <span style=color:#6272a4>// 将lo寄存器中移动到t3（所有的move指令都相当于赋值语句，复制后原值不会改变，而不是“移动”）
</span></span></span><span style=display:flex><span>    addu $t2, $t2, $t3  <span style=color:#6272a4>//在首地址t2基础上加上偏移量t3
</span></span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    la $a0,message_input_array <span style=color:#6272a4>//输出前导字符串
</span></span></span><span style=display:flex><span>    li $v0,<span style=color:#bd93f9>4</span>
</span></span><span style=display:flex><span>    syscall
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    li $v0, <span style=color:#bd93f9>5</span>          <span style=color:#6272a4>//输入数字
</span></span></span><span style=display:flex><span>    syscall
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    sw $v0, <span style=color:#bd93f9>0</span>($t2)     <span style=color:#6272a4>// 从寄存器存入数组中对应的地址 这里的t2就是刚刚计算过的地址
</span></span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    addi $t1, $t1, <span style=color:#bd93f9>1</span>	<span style=color:#6272a4>// 循环变量++
</span></span></span><span style=display:flex><span>    j for_1_begin
</span></span><span style=display:flex><span>    nop
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    <span style=color:#8be9fd;font-style:italic>for_1_end</span>:
</span></span><span style=display:flex><span>    move $v0, $t0
</span></span><span style=display:flex><span>    jr $ra             <span style=color:#6272a4>//跳回到主程序，跳转语句的下一条语句
</span></span></span><span style=display:flex><span>    nop
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4>//与input同理 无需多言！
</span></span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>output</span>:
</span></span><span style=display:flex><span>    move $t0, $a0
</span></span><span style=display:flex><span>    li $t1,<span style=color:#bd93f9>0</span>
</span></span><span style=display:flex><span>    la $a0,message_output_array
</span></span><span style=display:flex><span>    li $v0,<span style=color:#bd93f9>4</span>
</span></span><span style=display:flex><span>    syscall
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8be9fd;font-style:italic>for_2_begin</span>:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    slt $t2, $t1, $t0
</span></span><span style=display:flex><span>    beq $t2, $zero, for_2_end
</span></span><span style=display:flex><span>    nop
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    la $t2, array
</span></span><span style=display:flex><span>    li $t3, <span style=color:#bd93f9>4</span>
</span></span><span style=display:flex><span>    mult $t3, $t1
</span></span><span style=display:flex><span>    mflo $t3
</span></span><span style=display:flex><span>    addu $t2, $t2, $t3
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    lw $a0,<span style=color:#bd93f9>0</span>($t2)
</span></span><span style=display:flex><span>    li $v0,<span style=color:#bd93f9>1</span>
</span></span><span style=display:flex><span>    syscall
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    la $a0,space
</span></span><span style=display:flex><span>    li $v0,<span style=color:#bd93f9>4</span>
</span></span><span style=display:flex><span>    syscall
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    addi $t1, $t1, <span style=color:#bd93f9>1</span>	
</span></span><span style=display:flex><span>    j for_2_begin
</span></span><span style=display:flex><span>    nop
</span></span><span style=display:flex><span>    <span style=color:#8be9fd;font-style:italic>for_2_end</span>:
</span></span><span style=display:flex><span>    jr $ra
</span></span><span style=display:flex><span>    nop
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>sort</span>:
</span></span><span style=display:flex><span>    addiu $sp,$sp,<span style=color:#ff79c6>-</span><span style=color:#bd93f9>32</span> <span style=color:#6272a4>//向低地址移动32字节
</span></span></span><span style=display:flex><span>    move $t0,$a0   <span style=color:#6272a4>//此时a0值即为元素个数
</span></span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    li $t1,<span style=color:#bd93f9>0</span>  <span style=color:#6272a4>//循环变量
</span></span></span><span style=display:flex><span>    <span style=color:#8be9fd;font-style:italic>for_4_begin</span>:
</span></span><span style=display:flex><span>    slt $t2, $t1, $t0   <span style=color:#6272a4>//选择排序外层循环n-1趟
</span></span></span><span style=display:flex><span>    beq $t2, $zero, for_4_end
</span></span><span style=display:flex><span>    nop
</span></span><span style=display:flex><span>    <span style=color:#6272a4>//计算地址
</span></span></span><span style=display:flex><span>    la $t2, array
</span></span><span style=display:flex><span>    li $t3, <span style=color:#bd93f9>4</span>
</span></span><span style=display:flex><span>    mult $t1, $t3
</span></span><span style=display:flex><span>    mflo $t3
</span></span><span style=display:flex><span>    addu $t2, $t2, $t3
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    move $a0, $t0
</span></span><span style=display:flex><span>    move $a1, $t1
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    <span style=color:#6272a4>//父函数维护t寄存器 入栈  需要注意的是多层调用时$ra的维护
</span></span></span><span style=display:flex><span>    sw $t2, <span style=color:#bd93f9>28</span>($sp)
</span></span><span style=display:flex><span>    sw $t1, <span style=color:#bd93f9>24</span>($sp)
</span></span><span style=display:flex><span>    sw $t0, <span style=color:#bd93f9>20</span>($sp)
</span></span><span style=display:flex><span>    sw $ra, <span style=color:#bd93f9>16</span>($sp) <span style=color:#6272a4>//这时的ra值需要保存 这里的ra值记录的是返回到主函数的指令地址 经过调用findmin后会变为返回到sort的地址!
</span></span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    jal findmin   <span style=color:#6272a4>//调用子函数
</span></span></span><span style=display:flex><span>    nop
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    <span style=color:#6272a4>//出栈
</span></span></span><span style=display:flex><span>    lw $ra, <span style=color:#bd93f9>16</span>($sp)
</span></span><span style=display:flex><span>    lw $t0, <span style=color:#bd93f9>20</span>($sp)
</span></span><span style=display:flex><span>    lw $t1, <span style=color:#bd93f9>24</span>($sp)
</span></span><span style=display:flex><span>    lw $t2, <span style=color:#bd93f9>28</span>($sp)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>     <span style=color:#6272a4>//交换值   v0地址与t2地址处存储的值,两个寄存器分别存储
</span></span></span><span style=display:flex><span>    lw $t3, <span style=color:#bd93f9>0</span>($v0)
</span></span><span style=display:flex><span>    lw $t4, <span style=color:#bd93f9>0</span>($t2)
</span></span><span style=display:flex><span>    sw $t3, <span style=color:#bd93f9>0</span>($t2)
</span></span><span style=display:flex><span>    sw $t4, <span style=color:#bd93f9>0</span>($v0)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    addi $t1,$t1,<span style=color:#bd93f9>1</span> <span style=color:#6272a4>//更新循环变量
</span></span></span><span style=display:flex><span>    j for_4_begin
</span></span><span style=display:flex><span>    nop
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8be9fd;font-style:italic>for_4_end</span>:
</span></span><span style=display:flex><span>    addiu $sp,$sp,<span style=color:#bd93f9>32</span>  <span style=color:#6272a4>//将申请的栈空间退回，栈指针回到高地址
</span></span></span><span style=display:flex><span>    jr $ra  <span style=color:#6272a4>//回到主程序
</span></span></span><span style=display:flex><span>    nop
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>findmin</span>:  <span style=color:#6272a4>//从sort中传入 a0值为n, a1值为外层循环变量i
</span></span></span><span style=display:flex><span>    la $t0,array
</span></span><span style=display:flex><span>    sll $a0,$a0,<span style=color:#bd93f9>2</span>
</span></span><span style=display:flex><span>    subi $a0,$a0,<span style=color:#bd93f9>4</span>   <span style=color:#6272a4>//需要注意的是在 * 4的基础上需要减去4，
</span></span></span><span style=display:flex><span>    addu $t0,$t0,$a0  <span style=color:#6272a4>//当前的地址是数组中最后一个元素的地址
</span></span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    lw $t1, <span style=color:#bd93f9>0</span>($t0)    <span style=color:#6272a4>// t1=a[n-1]
</span></span></span><span style=display:flex><span>    move $t2,$t0
</span></span><span style=display:flex><span>    move $t3,$t0      <span style=color:#6272a4>// t3 = t2 = t0 = 最后一个元素地址
</span></span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    <span style=color:#6272a4>// a[i+1]
</span></span></span><span style=display:flex><span>    la $t0,array
</span></span><span style=display:flex><span>    sll $a1,$a1,<span style=color:#bd93f9>2</span>
</span></span><span style=display:flex><span>    addu $t0,$t0,$a1<span style=color:#6272a4>// t0此时为a[i+1]地址
</span></span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8be9fd;font-style:italic>for_3_begin</span>:
</span></span><span style=display:flex><span>    sge $t4,$t3,$t0 <span style=color:#6272a4>// t4 = 1 if t3 &gt;= t0
</span></span></span><span style=display:flex><span>    beq $t4,$zero,for_3_end
</span></span><span style=display:flex><span>    nop
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    lw $t5,<span style=color:#bd93f9>0</span>($t3)  <span style=color:#6272a4>// t5=a[n-1]
</span></span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    <span style=color:#6272a4>// 进入查找时 t3为最后一个元素地址 ,t0为a[i+1]地址
</span></span></span><span style=display:flex><span>    <span style=color:#6272a4>//这里寻找最小值的操作实际上是从末尾开始的，先记t1=a[n-1]为最小值，之后由哨兵 t5=遍历到的值 从n-1逐步向前遍历直到 i+1
</span></span></span><span style=display:flex><span>    <span style=color:#6272a4>//不断更新t1的值作为新的最小值，并在t2中保存最小值地址 t3
</span></span></span><span style=display:flex><span>    <span style=color:#6272a4>//这里t1被设置为保存最小值 如果当前遍历的元素小于t1最小值则进入下方更新最小值操作，否则进入if_1_else,顺序进入if_1_end遍历     //下一个元素
</span></span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    slt $t6,$t5,$t1   <span style=color:#6272a4>// t6 = 1 if t5 &lt; t1   第一次运行时 t5 = t1 直接跳转到 if_1_else
</span></span></span><span style=display:flex><span>    beq $t6,$zero,if_1_else
</span></span><span style=display:flex><span>    nop
</span></span><span style=display:flex><span>    move $t1,$t5   <span style=color:#6272a4>//更新最小值
</span></span></span><span style=display:flex><span>    move $t2,$t3   <span style=color:#6272a4>//保存最小值在数组中的的地址
</span></span></span><span style=display:flex><span>    j if_1_end
</span></span><span style=display:flex><span>    nop
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8be9fd;font-style:italic>if_1_else</span>:<span style=color:#6272a4>// if_1_else后误操作则直接执行 if_1_end  在标签之间无跳转时按照顺序执行
</span></span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#8be9fd;font-style:italic>if_1_end</span>:
</span></span><span style=display:flex><span>    subi $t3,$t3,<span style=color:#bd93f9>4</span> <span style=color:#6272a4>//t3从末尾向前移动一个元素，更新遍历元素
</span></span></span><span style=display:flex><span>    j for_3_begin
</span></span><span style=display:flex><span>    nop
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8be9fd;font-style:italic>for_3_end</span>:
</span></span><span style=display:flex><span>    move $v0,$t2
</span></span><span style=display:flex><span>    jr $ra <span style=color:#6272a4>//回到主程序
</span></span></span><span style=display:flex><span>    nop
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>main</span>:
</span></span><span style=display:flex><span>    la $sp, stack   
</span></span><span style=display:flex><span>    addiu $sp,$sp,<span style=color:#bd93f9>100</span>  <span style=color:#6272a4>//此处sp+100是将指针向高地址移动
</span></span></span><span style=display:flex><span>    addiu $sp,$sp,<span style=color:#ff79c6>-</span><span style=color:#bd93f9>20</span>  <span style=color:#6272a4>//-20向低地址移动
</span></span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    jal input   <span style=color:#6272a4>//跳转到input
</span></span></span><span style=display:flex><span>    nop
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    move $t0,$v0 <span style=color:#6272a4>//回到位置
</span></span></span><span style=display:flex><span>    move $a0,$t0
</span></span><span style=display:flex><span>    sw $t0, <span style=color:#bd93f9>16</span>($sp) <span style=color:#6272a4>//向高地址偏移量为16  调用者维护t寄存器，将t0入栈
</span></span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    jal sort
</span></span><span style=display:flex><span>    nop
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    lw $t0,<span style=color:#bd93f9>16</span>($sp) <span style=color:#6272a4>// t0出栈
</span></span></span><span style=display:flex><span>    move $a0,$t0
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    jal output
</span></span><span style=display:flex><span>    nop
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    addiu $sp,$sp,<span style=color:#bd93f9>20</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    li $v0,<span style=color:#bd93f9>10</span>  <span style=color:#6272a4>//程序结束
</span></span></span><span style=display:flex><span>    syscall
</span></span></code></pre></td></tr></table></div></div><p>​ <strong>上述选择排序算法较为复杂，主体结构为<code>main</code>调用<code>input</code>,<code>sort</code>,<code>output</code>函数，在<code>sort</code>中又调用<code>findmin</code>子函数</strong></p><p><strong>在MARS中的运行配置：</strong></p><ul><li>delayed branching</li><li>initial program counter to global &ldquo;main&rdquo; if defined</li><li>address configuration: compact ,data at address 0</li></ul><p>​ <strong>需要注意的是多层函数调用时除了经典的父函数维护t寄存器，子函数维护s寄存器，还要对<code>ra</code>寄存器进行维护</strong>,经典的例子是在<code>sort</code>调用<code>findmin</code>过程中，<code>$ra</code>一开始存储的值是<code>sort</code>函数返回到主函数<code>main</code>下一条指令的地址，经过调用<code>findmin</code>,寄存器<code>$ra</code>中的值会被自动更新为<code>findmin</code>跳回到<code>sort</code>的指令地址，故需要保存跳回到<code>main</code>的指令地址，对<code>$ra</code>进行维护！！！</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#6272a4>//选择排序的C语言实现
</span></span></span><span style=display:flex><span><span style=color:#8be9fd>void</span> <span style=color:#50fa7b>selectSort</span>(<span style=color:#8be9fd>int</span> k[],<span style=color:#8be9fd>int</span> n)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#8be9fd>int</span> i,j,d;
</span></span><span style=display:flex><span>    <span style=color:#8be9fd>int</span> temp;
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>for</span>(i<span style=color:#ff79c6>=</span><span style=color:#bd93f9>0</span>;i<span style=color:#ff79c6>&lt;</span>n<span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>;i<span style=color:#ff79c6>++</span>){
</span></span><span style=display:flex><span>        d<span style=color:#ff79c6>=</span>i;
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>for</span>(j<span style=color:#ff79c6>=</span>i<span style=color:#ff79c6>+</span><span style=color:#bd93f9>1</span>;j<span style=color:#ff79c6>&lt;</span>n;j<span style=color:#ff79c6>++</span>){<span style=color:#6272a4>//从后n-i+1中选取
</span></span></span><span style=display:flex><span>            <span style=color:#ff79c6>if</span>(k[j]<span style=color:#ff79c6>&lt;</span>k[d])d<span style=color:#ff79c6>=</span>j; <span style=color:#6272a4>//找到后面最小的元素
</span></span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>if</span>(d<span style=color:#ff79c6>!=</span>i)<span style=color:#6272a4>//放在排好队的序列最后面
</span></span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            temp<span style=color:#ff79c6>=</span>k[d];
</span></span><span style=display:flex><span>            k[d]<span style=color:#ff79c6>=</span>k[i];
</span></span><span style=display:flex><span>            k[i]<span style=color:#ff79c6>=</span>temp;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h4 id=二函数调用>二.函数调用<a hidden class=anchor aria-hidden=true href=#二函数调用>#</a></h4><p>​ 对于函数调用，可以看成在函数调用的这条语句，程序跳转到函数的内容处开始执行，执行完整个函数后再跳转回到调用处向下执行，这个跳转过程可以用汇编语言中的跳转指令和标签实现。</p><pre tabindex=0><code class=language-MIPS data-lang=MIPS># function call
jal function_name



# function
function_name:
    &lt;function-content&gt;
    jr $ra
</code></pre><p>​ 在这里我们的跳转指令选择<code>jal</code>而非<code>j</code>, <code>jal = jump and link</code>,相比j指令，<code>jal</code>多了将<code>PC+4 </code>写入<code>$ra</code>的过程,即记录跳转语句下一条语句的地址。当函数结束时，会返回到之前调用它的位置，并执行下一条指令。故我们常常搭配使用<code>jal</code>和<code>j</code>.</p><p>​ <strong>例如简单的C语言代码，计算两数相加</strong></p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#ff79c6>#include</span><span style=color:#ff79c6>&lt;stdio.h&gt;</span><span style=color:#ff79c6>
</span></span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8be9fd>int</span> <span style=color:#50fa7b>sum</span>(<span style=color:#8be9fd>int</span> a, <span style=color:#8be9fd>int</span> b)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#8be9fd>int</span> tmp <span style=color:#ff79c6>=</span> a <span style=color:#ff79c6>+</span> b;
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> tmp;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8be9fd>int</span> <span style=color:#50fa7b>main</span>()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#8be9fd>int</span> a <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>2</span>;
</span></span><span style=display:flex><span>    <span style=color:#8be9fd>int</span> b <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>3</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8be9fd>int</span> ans <span style=color:#ff79c6>=</span> <span style=color:#50fa7b>sum</span>(a, b);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#50fa7b>printf</span>(<span style=color:#f1fa8c>&#34;%d</span><span style=color:#f1fa8c>\n</span><span style=color:#f1fa8c>&#34;</span>, ans);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> <span style=color:#bd93f9>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>​ <strong>翻译成汇编语言</strong></p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-c data-lang=c><span style=display:flex><span>.macro end
</span></span><span style=display:flex><span>    li $v0,<span style=color:#bd93f9>10</span>
</span></span><span style=display:flex><span>    syscall
</span></span><span style=display:flex><span>.end_macro
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>.text
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>main</span>:
</span></span><span style=display:flex><span>li $s0, <span style=color:#bd93f9>2</span>
</span></span><span style=display:flex><span>li $s1, <span style=color:#bd93f9>3</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>jal sum
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>move $a0, $s2
</span></span><span style=display:flex><span>li $v0,<span style=color:#bd93f9>1</span>
</span></span><span style=display:flex><span>syscall
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>end  <span style=color:#6272a4>//marco
</span></span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>sum</span>:
</span></span><span style=display:flex><span>add $s2,$s0,$s1
</span></span><span style=display:flex><span>jr $ra
</span></span></code></pre></td></tr></table></div></div><h4 id=三复用代码>三.复用代码<a hidden class=anchor aria-hidden=true href=#三复用代码>#</a></h4><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#8be9fd>int</span> <span style=color:#50fa7b>sum</span>(<span style=color:#8be9fd>int</span> a, <span style=color:#8be9fd>int</span> b)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#8be9fd>int</span> tmp <span style=color:#ff79c6>=</span> a <span style=color:#ff79c6>+</span> b;
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> tmp;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8be9fd>int</span> <span style=color:#50fa7b>main</span>()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#8be9fd>int</span> a <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>2</span>;
</span></span><span style=display:flex><span>    <span style=color:#8be9fd>int</span> b <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>3</span>;
</span></span><span style=display:flex><span>    <span style=color:#8be9fd>int</span> c <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>4</span>;
</span></span><span style=display:flex><span>    <span style=color:#8be9fd>int</span> d <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>5</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8be9fd>int</span> sum1 <span style=color:#ff79c6>=</span> <span style=color:#50fa7b>sum</span>(a, b);
</span></span><span style=display:flex><span>    <span style=color:#50fa7b>printf</span>(<span style=color:#f1fa8c>&#34;%d&#34;</span>, sum1);
</span></span><span style=display:flex><span>    sum2 <span style=color:#ff79c6>=</span> <span style=color:#50fa7b>sum</span>(c, d);
</span></span><span style=display:flex><span>    <span style=color:#50fa7b>printf</span>(<span style=color:#f1fa8c>&#34;%d&#34;</span>, sum2);
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> <span style=color:#bd93f9>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>​ 上面的C程序，sum代码是可以进行复用的，但是在我们原来的汇编代码中，操作的寄存器是固定的，即<code>$s0,$s1,$s2</code>,为了复用代码（可以对其他寄存器进行操作），就必须要让一些特定寄存器作为“接收器”，对于不同的参数，都采用同一组寄存器来存储它们的值，也就是我们说的函数传参寄存器<code>$a0.$a1,$a2,$a3</code>,同样，对于返回值，也需要指定特定的寄存器。</p><pre tabindex=0><code class=language-MIPS data-lang=MIPS>//利用宏进行代码复用
.macro end
   li $v0,10
   syscall
.end_macro

.macro printStr(%Str)
    la $a0,%Str
    li $v0,4
    syscall
.end_macro

.data
   space: .asciiz &#34; &#34;
   
.text

li $t0,1
li $t1,2
li $t2,3
li $t3,4

#传参 $a0,$a1作为桥梁作用
move $a0,$s0
move $a1,$s1
jal sum
move $s4,$v0

li $v0,1
move $a0,$s4
syscall

printStr(space)

move $a0,$s2
move $a1,$s3
jal sum
move $s5,$v0

li $v0,1
move $a0,$s5
syscall

end

sum:
#传参
move $t0,$a0
move $t1,$a1
add $v0,$t0,$t1
jr $ra
</code></pre><p>​ <strong>如果传参过程中<code>$a0,$a1,$a2,$a3</code>不够用（参数超过四个），可以利用栈<code>$sp</code>,将多余的参数存入内存中</strong>。</p><h4 id=四避免对外界造成影响>四.避免对外界造成影响<a hidden class=anchor aria-hidden=true href=#四避免对外界造成影响>#</a></h4><p>​ 函数还有一个重要的功能是不对函数体外的变量造成不必要的影响</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#8be9fd>int</span> <span style=color:#50fa7b>sum</span>(<span style=color:#8be9fd>int</span> a, <span style=color:#8be9fd>int</span> b)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#8be9fd>int</span> tmp <span style=color:#ff79c6>=</span> a <span style=color:#ff79c6>+</span> b;
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> tmp;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8be9fd>int</span> <span style=color:#50fa7b>main</span>()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#8be9fd>int</span> a <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>2</span>;
</span></span><span style=display:flex><span>    <span style=color:#8be9fd>int</span> b <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>3</span>;
</span></span><span style=display:flex><span>    <span style=color:#8be9fd>int</span> c <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>4</span>;
</span></span><span style=display:flex><span>    <span style=color:#8be9fd>int</span> sum1 <span style=color:#ff79c6>=</span> <span style=color:#50fa7b>sum</span>(a, b);
</span></span><span style=display:flex><span>    <span style=color:#8be9fd>int</span> sum2 <span style=color:#ff79c6>=</span> <span style=color:#50fa7b>sum</span>(sum1, c);
</span></span><span style=display:flex><span>    <span style=color:#50fa7b>printf</span>(<span style=color:#f1fa8c>&#34;%d&#34;</span>, sum2);
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> <span style=color:#bd93f9>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>​ 汇编</p><pre tabindex=0><code class=language-MIPS data-lang=MIPS>.macro end
    li      $v0, 10
    syscall
.end_macro

.text
li      $s0, 2
li      $s1, 3
li      $t0, 4

move    $a0, $s0 #传参
move    $a1, $s1
jal     sum
move    $s4, $v0 #获得返回值

move    $a0, $s4
move    $a1, $t0
jal     sum
move    $s5, $v0

li      $v0, 1
move    $a0, $s5
syscall

end

sum:
#传参过程
move    $t0, $a0 #t0被修改了
move    $t1, $a1
#函数过程
add     $v0 $t0, $t1
jr      $ra
</code></pre><p>​ <strong>这里的问题在于，<code>$t0</code>在主函数中存储变量值,而在sum函数中用于接受参数，改变了原来的变量值</strong>，即函数对外部产生了影响！</p><p>​ 所以我们需要保证函数不会对外部造成影响，方法就是应用栈，利用栈来保存和恢复函数中所使用的寄存器。</p><p>在哪里维护寄存器：</p><ul><li><strong>t寄存器</strong>：在调用者中进行维护‘</li><li><strong>s寄存器</strong>：在被调用者中进行维护</li></ul><h5 id=1在调用者中进行维护>1.在调用者中进行维护<a hidden class=anchor aria-hidden=true href=#1在调用者中进行维护>#</a></h5><pre tabindex=0><code class=language-MIPS data-lang=MIPS>.macro end
    li      $v0, 10
    syscall
.end_macro

.text
li      $s0, 2
li      $s1, 3
li      $t0, 4

move    $a0, $s0 #传参
move    $a1, $s1

#进行维护 入栈
sw      $t0, 0($sp)
addi    $sp, $sp, -4

jal     sum

#出栈
addi    $sp, $sp, 4
lw      $t0, 0($sp) 

move    $s4, $v0 #获得返回值

move    $a0, $s4
move    $a1, $t0

sw      $t0, 0($sp) #入栈
addi    $sp, $sp, -4

jal     sum

addi    $sp, $sp, 4 #出栈
lw      $t0, 0($sp)

move    $s5, $v0

li      $v0, 1
move    $a0, $s5
syscall

end

sum:
#传参过程
move    $t0, $a0
move    $t1, $a1
#函数过程
add     $v0 $t0, $t1
jr      $ra
</code></pre><p>​ **在以上代码中，只涉及到对t寄存器的维护，故只需要在主函数中使用栈，在子函数中无需使用栈，**在发觉这一点之前，我对于主函数中对于栈指针<code>$sp</code>移动的操作表示迷惑，认为完全可以删去这两行代码。<strong>事实上，如果在一个参数的入栈与出栈之间没有对<code>$sp</code>进行任何操作，确实可以不移动<code>$sp</code></strong>,但事实上，<strong>考虑到我们习惯上第一个参数入栈表达为 <code>lw $s0 0($sp)</code>,即相对于栈指针地址没有偏移，而如果我们在子函数中这样存入，在主函数中又没有移动<code>$sp</code>,无疑会覆盖掉我们在那个位置上保存的参数，从而发生bug</strong>,(杠精当然可以说我会写<code>lw $s0, 4($sp)</code>），但这样写在主函数中维护寄存器数量很多时很费笔墨，不如移动栈指针来的简洁。<strong>当然，我们在子函数中同样需要注意栈指针的移动，在子函数结束时即使释放栈空间，防止覆写主函数中维护的参数。</strong></p><h5 id=2在被调用者中维护>2.在被调用者中维护<a hidden class=anchor aria-hidden=true href=#2在被调用者中维护>#</a></h5><pre tabindex=0><code class=language-MIPS data-lang=MIPS>.macro end
    li      $v0, 10
    syscall
.end_macro

.text
li      $s0, 2
li      $s1, 3
li      $t0, 4

move    $a0, $s0 #传参
move    $a1, $s1
jal     sum
move    $s4, $v0 #获得返回值

move    $a0, $s4
move    $a1, $t0
jal     sum
move    $s5, $v0

li      $v0, 1
move    $a0, $s5
syscall

end

sum:
#入栈过程
sw      $t0, 0($sp)
addi    $sp, $sp, -4
#传参过程
move    $t0, $a0
move    $t1, $a1
#函数过程
add     $v0 $t0, $t1
#出栈过程
addi    $sp, $sp, 4
lw      $t0, 0($sp)
#return
jr      $ra
</code></pre><h4 id=五嵌套函数调用>五.嵌套函数调用<a hidden class=anchor aria-hidden=true href=#五嵌套函数调用>#</a></h4><p>​ <strong>嵌套函数调用的重要意识是用栈保存<code>$ra</code>，以保存向外层函数的跳转，这一点我在sort程序中就有发现，还是有一定理解能力(<code>bushi</code>).</strong></p><p>​ 嵌套函数的C语言例子</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#8be9fd>int</span> <span style=color:#50fa7b>sum</span>(<span style=color:#8be9fd>int</span> a, <span style=color:#8be9fd>int</span> b)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> a <span style=color:#ff79c6>+</span> b;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#8be9fd>int</span> <span style=color:#50fa7b>cal</span>(<span style=color:#8be9fd>int</span> a, <span style=color:#8be9fd>int</span> b)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> a <span style=color:#ff79c6>-</span> <span style=color:#50fa7b>sum</span>(b, a);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8be9fd>int</span> <span style=color:#50fa7b>main</span>()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#8be9fd>int</span> a <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>2</span>;
</span></span><span style=display:flex><span>    <span style=color:#8be9fd>int</span> b <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>3</span>;
</span></span><span style=display:flex><span>    <span style=color:#8be9fd>int</span> ans <span style=color:#ff79c6>=</span> <span style=color:#50fa7b>cal</span>(<span style=color:#bd93f9>2</span>, <span style=color:#bd93f9>3</span>);
</span></span><span style=display:flex><span>    <span style=color:#50fa7b>printf</span>(<span style=color:#f1fa8c>&#34;%d&#34;</span>, ans);
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>​ 其中cal函数嵌套调用sum函数。</p><pre tabindex=0><code class=language-MIPS data-lang=MIPS>.macro end
    li $v0, 10
    syscall
.end_macro

.text
li      $s0, 2
li      $s1, 3

move    $a0, $s0
move    $a1, $s1
jal     cal
move    $s5, $v0

li      $v0, 1
move    $a0, $s5
syscall

end

sum:
#传参过程
move    $t0, $a0
move    $t1, $a1
#函数过程
add     $v0, $t0, $t1
#return
jr      $ra

cal:
#传参过程
move    $t0, $a0
move    $t1, $a1
#调用sum的过程
move    $a0, $t1
move    $a1, $t0
jal     sum
move    $t2, $v0
#运算a-sum(b, a)
sub     $v0, $t0, $t2 
#return
jr      $ra  #错误的地址值 造成死循环
</code></pre><p>​ <strong>这段代码会陷入死循环！在cal调用sum时，<code>$ra</code>中的值由cal跳回主函数的地址由<code>jal</code>指令更改为sum跳回cal的地址，因此会陷入死循环。</strong></p><p>​ <strong>所以我们可以总结出：在嵌套函数调用中，一旦一个函数不是叶子函数（调用逻辑的最低端），就需要保存和恢复<code>$ra</code>,以能够正常一层一层向上返回。</strong></p><p>​ 以下为在父一级函数中对<code>$ra</code>进行维护的正确代码</p><pre tabindex=0><code class=language-MIPS data-lang=MIPS>.macro end
    li $v0, 10
    syscall
.end_macro

.text
li      $s0, 2
li      $s1, 3

move    $a0, $s0
move    $a1, $s1
jal     cal
move    $s5, $v0

li      $v0, 1
move    $a0, $s5
syscall

end

sum:
#将 $t0 和 $t1 入栈
sw      $t0, 0($sp)
addi    $sp, $sp, -4
sw      $t1, 0($sp)
addi    $sp, $sp, -4
#传参过程
move    $t0, $a0
move    $t1, $a1
#函数过程
add     $v0 $t0, $t1
#将 $t0 和 $t1 出栈
addi    $sp, $sp, 4
lw      $t1, 0($sp) 
addi    $sp, $sp, 4
lw      $t0, 0($sp) 
#return
jr      $ra

cal:
#将 $ra 入栈
sw      $ra, 0($sp)
addi    $sp, $sp, -4
#传参过程
move    $t0, $a0
move    $t1, $a1
#调用 sum 的过程
move    $a0, $t1
move    $a1, $t0
jal     sum
move    $t2, $v0
#运算a-sum(b, a)
sub     $v0, $t0, $t2
#将ra出栈
addi    $sp, $sp, 4
lw      $ra, 0($sp) 
#return
jr      $ra
</code></pre><h4 id=六递归函数调用>六.递归函数调用<a hidden class=anchor aria-hidden=true href=#六递归函数调用>#</a></h4><p>​ 最后的部分：递归函数的汇编翻译，<strong>递归函数的本质是一个在函数体内调用自身的嵌套函数</strong>。</p><p>​ C语言阶乘</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#ff79c6>#include</span> <span style=color:#ff79c6>&lt;stdio.h&gt;</span><span style=color:#ff79c6>
</span></span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8be9fd>int</span> <span style=color:#50fa7b>factorial</span>(<span style=color:#8be9fd>int</span> n)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>if</span> (n <span style=color:#ff79c6>==</span> <span style=color:#bd93f9>1</span>)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>return</span> <span style=color:#bd93f9>1</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>else</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>return</span> n <span style=color:#ff79c6>*</span> <span style=color:#50fa7b>factorial</span>(n <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>1</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8be9fd>int</span> <span style=color:#50fa7b>main</span>()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#50fa7b>printf</span>(<span style=color:#f1fa8c>&#34;%d</span><span style=color:#f1fa8c>\n</span><span style=color:#f1fa8c>&#34;</span>, <span style=color:#50fa7b>factorial</span>(<span style=color:#bd93f9>5</span>));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> <span style=color:#bd93f9>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>​ 汇编版本</p><pre tabindex=0><code class=language-MIPS data-lang=MIPS># 程序结束
.macro end
    li      $v0, 10
    syscall
.end_macro

# 从标准输入处得到一个整型变量，并存储到 %des 寄存器中
.macro getInt(%des)
    li      $v0, 5
    syscall
    move    %des, $v0
.end_macro

# 向标准输出中写入一个数据，这个数据保存在 %src 寄存器中
.macro printInt(%src)
    move    $a0, %src
    li      $v0, 1
    syscall
.end_macro

# 将寄存器 %src 中的数据入栈
.macro push(%src)
    sw      %src, 0($sp)
    subi    $sp, $sp, 4  #入栈栈指针向低地址移动
.end_macro

# 将栈顶数据出栈，并保存在 %des 寄存器中
.macro pop(%des)
    addi    $sp, $sp, 4  # 出栈栈指针向高地址移动
    lw      %des, 0($sp) 
.end_macro

.text
main:
    getInt($s0)

    move    $a0, $s0
    jal     factorial   #最终结果存储在$v0中
    move    $s1, $v0

    printInt($s1)
    end


factorial:
    # 入栈
    push($ra)
    push($t0)
    # 传参
    move    $t0, $a0
    #函数过程
    bne     $t0, 1, else
    # 基准情况
    if:
        li      $v0, 1
        j       if_end  
    # 递归情况  
    else:
        subi    $t1, $t0, 1
        move    $a0, $t1
        jal     factorial
        mult    $t0, $v0
        mflo    $v0
    if_end:
    # 出栈
    pop($t0)
    pop($ra)
    # 返回
    jr   $ra
</code></pre><p>​ <strong>我们可以预想到，调用过递归函数的栈中，一定是整整齐齐的存储了一排<code>$ra</code>值</strong></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://coder0xe.github.io/tags/sep/>Sep</a></li></ul><nav class=paginav><a class=prev href=https://coder0xe.github.io/posts/mipsaddress/><span class=title>« Prev</span><br><span>MIPS中自动存入地址的指令</span>
</a><a class=next href=https://coder0xe.github.io/posts/mipcoding/><span class=title>Next »</span><br><span>MIPS基础编程</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share MIPS中的函数调用 on x" href="https://x.com/intent/tweet/?text=MIPS%e4%b8%ad%e7%9a%84%e5%87%bd%e6%95%b0%e8%b0%83%e7%94%a8&amp;url=https%3a%2f%2fcoder0xe.github.io%2fposts%2fmipsfunc%2f&amp;hashtags=Sep"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share MIPS中的函数调用 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fcoder0xe.github.io%2fposts%2fmipsfunc%2f&amp;title=MIPS%e4%b8%ad%e7%9a%84%e5%87%bd%e6%95%b0%e8%b0%83%e7%94%a8&amp;summary=MIPS%e4%b8%ad%e7%9a%84%e5%87%bd%e6%95%b0%e8%b0%83%e7%94%a8&amp;source=https%3a%2f%2fcoder0xe.github.io%2fposts%2fmipsfunc%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share MIPS中的函数调用 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fcoder0xe.github.io%2fposts%2fmipsfunc%2f&title=MIPS%e4%b8%ad%e7%9a%84%e5%87%bd%e6%95%b0%e8%b0%83%e7%94%a8"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share MIPS中的函数调用 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fcoder0xe.github.io%2fposts%2fmipsfunc%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share MIPS中的函数调用 on whatsapp" href="https://api.whatsapp.com/send?text=MIPS%e4%b8%ad%e7%9a%84%e5%87%bd%e6%95%b0%e8%b0%83%e7%94%a8%20-%20https%3a%2f%2fcoder0xe.github.io%2fposts%2fmipsfunc%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share MIPS中的函数调用 on telegram" href="https://telegram.me/share/url?text=MIPS%e4%b8%ad%e7%9a%84%e5%87%bd%e6%95%b0%e8%b0%83%e7%94%a8&amp;url=https%3a%2f%2fcoder0xe.github.io%2fposts%2fmipsfunc%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentColor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share MIPS中的函数调用 on ycombinator" href="https://news.ycombinator.com/submitlink?t=MIPS%e4%b8%ad%e7%9a%84%e5%87%bd%e6%95%b0%e8%b0%83%e7%94%a8&u=https%3a%2f%2fcoder0xe.github.io%2fposts%2fmipsfunc%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2026 <a href=https://coder0xe.github.io/>coder0xe's blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>